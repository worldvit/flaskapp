{% extends "base.html" %}
{% block title %}{{ post.title }}{% endblock %}
{% block header_title %}{{ post.title }}{% endblock %}
{% block content %}
<style>
.post-header { margin-bottom: 20px; border-bottom: 1px solid #eee; padding-bottom: 10px; }
.post-meta { color: #777; font-size: 0.9em; margin-bottom: 15px; }
.post-content { line-height: 1.6; margin-bottom: 30px; min-height: 150px; white-space: pre-wrap; }
.post-actions { margin-bottom: 30px; }
.btn-edit { background-color: #ffc107; color: #333; padding: 8px 15px; text-decoration: none; border-radius: 5px; }
.btn-delete { background-color: #dc3545; color: white; padding: 8px 15px; border: none; border-radius: 5px; cursor: pointer; }
.comments-section { border-top: 2px solid #eee; padding-top: 20px; }
.comment-item { border-bottom: 1px solid #eee; padding: 10px 0; }
.comment-meta { font-size: 0.8em; color: #777; margin-bottom: 5px; }
.comment-form { margin-top: 20px; }
.comment-form textarea { width: 100%; height: 80px; padding: 10px; box-sizing: border-box; margin-bottom: 10px; border: 1px solid #ccc; border-radius: 4px; }
.btn-comment { background-color: #007bff; color: white; padding: 8px 15px; border: none; border-radius: 5px; cursor: pointer; }
</style>

<div class="post-header">
    <div class="post-meta">
        작성자: {{ post.username }} | 작성일: {{ post.created_at.strftime('%Y-%m-%d %H:%M') }}
        {% if post.created_at != post.updated_at %} | 수정일: {{ post.updated_at.strftime('%Y-%m-%d %H:%M') }}{% endif %}
    </div>
</div>

<div class="post-content">{{ post.content }}</div>

<div class="post-actions">
    <a href="{{ url_for('board_list') }}" class="btn-edit" style="background-color:#6c757d; color:white;">목록으로</a>
    {% if session.id == post.user_id %}
    <a href="{{ url_for('edit_post', post_id=post.id) }}" class="btn-edit">수정</a>
    <form action="{{ url_for('delete_post', post_id=post.id) }}" method="post" style="display:inline;" onsubmit="return confirm('정말로 이 게시글을 삭제하시겠습니까?');">
        <button type="submit" class="btn-delete">삭제</button>
    </form>
    {% endif %}
</div>

<div class="comments-section">
    <h3>댓글 ({{ comments|length }})</h3>
    {% for comment in comments %}
    <div class="comment-item">
        <div class="comment-meta">{{ comment.username }} | {{ comment.created_at.strftime('%Y-%m-%d %H:%M') }}</div>
        <div>{{ comment.content }}</div>
    </div>
    {% else %}
    <p>아직 댓글이 없습니다. 첫 댓글을 남겨보세요!</p>
    {% endfor %}

    <form class="comment-form" action="{{ url_for('add_comment', post_id=post.id) }}" method="post">
        <textarea name="content" required placeholder="댓글을 입력하세요..."></textarea>
        <button type="submit" class="btn-comment">댓글 작성</button>
    </form>
</div>
{% endblock %}
